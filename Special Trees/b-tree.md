## 📘 درخت بی (B-Tree)


### 1️⃣ درسنامه

درخت بی (B-Tree) یک ساختار داده‌ای درختیِ خود-متوازن است که اجازه می‌دهد عملیات جستجو، دسترسی ترتیبی، درج و حذف در زمان لگاریتمی انجام شود. برخلاف درخت‌های جستجوی دودویی، در درخت بی هر Node یا گره می‌تواند بیش از دو فرزند (Child) داشته باشد.

یک درخت بی دارای $n$ کلید غیرنزولی و $n + 1$ اشاره‌گر است. برگ‌ها هم‌سطح هستند و اشاره‌گرهای آنها تعریف نشده است. اگر t را درجه‌ی درخت بنامیم برای B-Tree ویژگی‌های زیر برای آن تعریف می‌شود:

- هر نود بجز ریشه باید حداقل $t - 1$ کلید داشته باشد. ریشه می‌تواند حداقل یک کلید داشته باشد.
- هر نود حداکثر $2t - 1$ کلید دارد.


**💡 قضیه:** اگر تعداد کل کلیدها $n$ و ارتفاع `h` و درجه `t` باشد آنگاه:

$h \le \log_t \frac{n+1}{2}$

**✅ اثبات:** تعداد نودها وقتی مینیمم است که ریشه یک کلید و سایر نودها دارای $t - 1$ کلید باشند، در این صورت در عمق صفر یک نود، در عمق یک $2$ نود، در عمق دو $2t$ نود، در عمق سه $2t^2$ نود و ... در عمق h تعداد $2t^{h-1}$ نود وجود دارد پس برای تعداد n کلید داریم:


$n \ge 1 + (t-1)\sum_{i=1}^{h} 2t^{i - 1} = 2t^{h} - 1 \Rightarrow  h \le \log_t \frac{n+1}{2}$


> **نکته:** درخت بی تعمیم‌یافته‌ی درخت جستجوی دودویی (BST) است که به‌جای دو فرزند، چندین فرزند دارد.

> **نکته:** عملیات جستجو، درج و حذف در این درخت از مرتبه‌ی $\mathcal{O}(t.h) = \mathcal{O}(t.\log_t(n))$ است.

> **نکته:** برای درج در درخت بی، از ریشه جستجو می‌کنیم و در مسیر جستجو هر نودی که شامل `2t - 1` کلید بود (به عبارتی پر بود) آن را دو قسمت می‌کنیم و کلید وسط آن نود را به نود پدرش منتقل می‌کنیم، البته ممکن است ارتفاع درحت یک واحد افزایش یابد. در نهایت کلید جدید در یک برگ درج می‌شود.

